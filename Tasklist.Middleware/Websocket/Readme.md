Idea taken from https://radu-matei.com/blog/aspnet-core-websockets-middleware/